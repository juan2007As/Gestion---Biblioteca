<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', filename='estilos_menu_libros.css') }}">
    <title>Biblioteca</title>
</head>
<body>
    <!-- Mostrar mensajes flash -->
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            <div class="alerts">
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }}">{{ message }}</div>
                {% endfor %}
            </div>
        {% endif %}
    {% endwith %}

    <div class="Box">
        <img src="{{ url_for('static', filename='imagenes/LogoInicial.jpg') }}" alt="Logo" class="Box__img">
        <h1 class="Box__Title">Administración de Biblioteca</h1>
        <div class="Box_administracion">
            <h2 class="Administracion__title">Gestión de libros:</h2>
            <input type="text" id="input__Busqueda" placeholder="Buscar por título, autor o ID...">
            <button id="Boton_Agregar">Agregar Libro</button>
            <button id="Boton_Eliminar">Eliminar Libro</button>
            <a href="{{ url_for('index') }}" class="btn-menu-principal">Menú Principal</a>
        </div>
    </div>
    <div id="Box__contenedor_menu" style="display: none">
        <div id="Agregar_libro_menu" class="Box__menu_agregar">
            <h1 class="form__title">Agregar Libro</h1>
            <form action="{{ url_for('agregar_libro_web') }}" method="post" class="form__prin">
                <input type="text" name="titulo" placeholder="Título..." required>
                <input type="text" name="autor" placeholder="Autor..." required>
                <input type="text" name="editorial" placeholder="Editorial..." required>
                <input type="number" name="año" placeholder="Año..." required>
                <input type="text" name="genero" placeholder="Género..." required>
                <button class="Form_button" type="submit">Agregar Libro</button>
                <a class="Link__form" href="{{ url_for('listar_libros') }}">Volver</a>
            </form>
        </div>
    </div>
    <div id="Box__contenedor_Delete" style="display: none">
        <div id="Eliminar_libro_menu" class="Box__menu_Eliminar">
            <h1 class="form__title">Eliminar Libro</h1>
            <form action="{{ url_for('eliminar_libros_web') }}" method="post">
                <input type="number" name="id_libro" placeholder="ID del libro" required>
                <button class="Form_button_delete" type="submit">Eliminar</button>
                <a class="Link__form" href="{{ url_for('listar_libros') }}">Volver</a>
            </form>
        </div>
    </div>
    <div id="Box__contenedor_Actualizar" style="display: none">
        <div id="Actualizar_libro_menu" class="Box__menu_Actualizar">
            <h1 class="form__title">Actualizar Libro</h1>
            <form action="{{ url_for('actualizar_libros_web') }}" method="post" class="form__prin">
                <input type="hidden" id="id_libro_actualizar" name="id_libro" value="">
                <input type="text" name="titulo" placeholder="Título..." id="titulo_actualizar">
                <input type="text" name="autor" placeholder="Autor..." id="autor_actualizar">
                <input type="text" name="editorial" placeholder="Editorial..." id="editorial_actualizar">
                <input type="number" name="año" placeholder="Año..." id="año_actualizar">
                <input type="text" name="genero" placeholder="Género..." id="genero_actualizar">
                <select name="disponible" id="disponible_actualizar">
                    <option value="">Mantener disponibilidad actual</option>
                    <option value="si">Disponible</option>
                    <option value="no">No disponible</option>
                </select>
                <button class="Form_button" type="submit">Actualizar</button>
                <button type="button" class="Link__form" onclick="ocultarMenuActualizar()">Cancelar</button>
            </form>
        </div>
    </div>
    <div class="Box Box__Tabla">
        <table class="Tabla__Libros" border="1">
            <thead>
                <tr>
                    <th>ID</th><th>Título</th><th>Autor</th><th>Editorial</th><th>Año</th><th>Género</th><th>Disponible</th><th></th>
                </tr>
            </thead>
            <tbody id="tableBody">
                {% for libro in libros %}
                <tr>
                    <td>{{ libro.id_libro }}</td>
                    <td>{{ libro.titulo }}</td>
                    <td>{{ libro.autor }}</td>
                    <td>{{ libro.editorial }}</td>
                    <td>{{ libro.año }}</td>
                    <td>{{ libro.genero }}</td>
                    <td>{{ "Sí" if libro.disponible else "No" }}</td>
                    <td id="fila_boton">
                        <button class="btn-actualizar" data-libro-id="{{ libro.id_libro }}">Actualizar</button>
                        <a href="{{ url_for('eliminar_libro_web', id_libro=libro.id_libro) }}" class="btn-eliminar">Eliminar</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    <script src="{{ url_for('static', filename='script_libros.js') }}"></script>
</body>
</html>