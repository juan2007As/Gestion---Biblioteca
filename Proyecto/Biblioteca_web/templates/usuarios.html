<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', filename='estilos_menu_usuarios.css') }}">
    <title>Biblioteca - Usuarios</title>
</head>
<body>
    <!-- Mostrar mensajes flash -->
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            <div class="alerts">
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }}">{{ message }}</div>
                {% endfor %}
            </div>
        {% endif %}
    {% endwith %}

    <div class="Box">
        <img src="{{ url_for('static', filename='imagenes/LogoInicial.jpg') }}" alt="Logo" class="Box__img">
        <h1 class="Box__Title">Administración de Biblioteca</h1>
        <div class="Box_administracion">
            <h2 class="Administracion__title">Gestión de usuarios:</h2>
            <input type="text" id="input__Busqueda" placeholder="Buscar por nombre, apellido o email...">
            <button id="Boton_Agregar">Agregar Usuario</button>
            <button id="Boton_Eliminar">Eliminar Usuario</button>
            <a href="{{ url_for('index') }}" class="btn-menu-principal"> Menú Principal</a>
        </div>
    </div>
    <div id="Box__contenedor_menu" style="display: none">
        <div id="Agregar_usuario_menu" class="Box__menu_agregar">
            <h1 class="form__title">Agregar Usuario</h1>
            <form action="{{ url_for('agregar_usuario_web') }}" method="post" class="form__prin">
                <input type="text" name="documento" placeholder="Documento (ej: 1234567890)..." required>
                <input type="text" name="nombre" placeholder="Nombre..." required>
                <input type="text" name="apellido" placeholder="Apellido..." required>
                <input type="text" name="telefono" placeholder="Teléfono..." required>
                <input type="email" name="email" placeholder="Email..." required>
                <select name="rol" required>
                    <option value="">Seleccionar rol...</option>
                    <option value="normal">Normal</option>
                    <option value="admin">Administrador</option>
                </select>
                <button class="Form_button" type="submit">Agregar Usuario</button>
                <a class="Link__form" href="{{ url_for('listar_usuarios') }}">Volver</a>
            </form>
        </div>
    </div>
    <div id="Box__contenedor_Delete" style="display: none">
        <div id="Eliminar_usuario_menu" class="Box__menu_Eliminar">
            <h1 class="form__title">Eliminar Usuario</h1>
            <form action="{{ url_for('eliminar_usuarios_web') }}" method="post">
                <input type="text" name="documento" placeholder="Documento del usuario" required>
                <button class="Form_button_delete" type="submit">Eliminar</button>
                <a class="Link__form" href="{{ url_for('listar_usuarios') }}">Volver</a>
            </form>
        </div>
    </div>
    <div id="Box__contenedor_Actualizar" style="display: none">
        <div id="Actualizar_usuario_menu" class="Box__menu_Actualizar">
            <h1 class="form__title">Actualizar Usuario</h1>
            <form action="{{ url_for('actualizar_usuarios_web') }}" method="post" class="form__prin">
                <input type="hidden" id="documento_usuario_actualizar" name="documento" value="">
                <input type="text" name="nombre" placeholder="Nombre..." id="nombre_actualizar">
                <input type="text" name="apellido" placeholder="Apellido..." id="apellido_actualizar">
                <input type="text" name="telefono" placeholder="Teléfono..." id="telefono_actualizar">
                <input type="email" name="email" placeholder="Email..." id="email_actualizar">
                <select name="rol" id="rol_actualizar">
                    <option value="">Mantener rol actual</option>
                    <option value="normal">Normal</option>
                    <option value="admin">Administrador</option>
                </select>
                <button class="Form_button" type="submit">Actualizar</button>
                <button type="button" class="Link__form" onclick="ocultarMenuActualizar()">Cancelar</button>
            </form>
        </div>
    </div>
    <div class="Box Box__Tabla">
        <table class="Tabla__Usuarios" border="1">
            <thead>
                <tr>
                    <th>Documento</th><th>Nombre</th><th>Apellido</th><th>Teléfono</th><th>Email</th><th>Rol</th><th></th>
                </tr>
            </thead>
            <tbody id="tableBody">
                {% for usuario in usuarios %}
                <tr>
                    <td>{{ usuario.documento }}</td>
                    <td>{{ usuario.nombre }}</td>
                    <td>{{ usuario.apellido }}</td>
                    <td>{{ usuario.telefono }}</td>
                    <td>{{ usuario.email }}</td>
                    <td>{{ usuario.rol }}</td>
                    <td id="fila_boton">
                        <button class="btn-actualizar" data-usuario-documento="{{ usuario.documento }}">Actualizar</button>
                        <a href="{{ url_for('eliminar_usuario_web', documento=usuario.documento) }}" class="btn-eliminar">Eliminar</a>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    <script src="{{ url_for('static', filename='script_usuarios.js') }}"></script>
</body>
</html>